# PostgreSQL configuration optimized for 2-core/4GB server
# Memory Settings - Conservative for shared hosting
shared_buffers = 64MB           # 64MB instead of default 128MB
effective_cache_size = 256MB    # How much memory OS has for caching
work_mem = 4MB                  # Per-operation memory (lower to prevent OOM)
maintenance_work_mem = 32MB     # For VACUUM, CREATE INDEX

# Connections
max_connections = 30            # Low for connection pooling setup

# Write-Ahead Log
wal_buffers = 4MB
checkpoint_completion_target = 0.9
min_wal_size = 80MB
max_wal_size = 256MB

# Query Planning
random_page_cost = 1.1          # SSD-optimized
effective_io_concurrency = 200  # SSD-optimized

# Logging - Minimal to save I/O
log_min_duration_statement = 1000  # Only log queries > 1s
log_checkpoints = off
log_connections = off
log_disconnections = off

# Background Writer - Smooth out writes
bgwriter_delay = 200ms
bgwriter_lru_maxpages = 100
bgwriter_lru_multiplier = 2.0

# Autovacuum - Less aggressive
autovacuum_max_workers = 1
autovacuum_naptime = 60s
